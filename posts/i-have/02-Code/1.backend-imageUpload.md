---
title: 图片上传实现
---

# 后端：图片上传实现

> 项目提供两种文件上传模式：
>
> local为本地上传，需要配置下方的imagesPath；imagesPath为你本地图片文件夹路径
>
> oss为阿里云上传，需要在阿里云中开通对象存储服务，配置相应的key

## 上传图片配置

::: code-group 

```yaml [local]
# 上传文件模式: local
uploadMode: local
# 文件上传映射本地路径
# 在项目的源文件夹中建立upload目录，用于文件上传
imagesPath: E:/git_repo/i-have/upload/
allowedMaxSize: 10MB
allowedTypes: jpg,jpeg,png,gif
url-prefix: http://localhost:3000/upload/
```

```yaml [oss]
# 上传文件模式: oss
uploadMode: oss
# 在阿里云中开通对象存储服务，配置相应的key

```

:::

## ImageUtil工具类

- ✅ 添加了完整的文件验证功能（类型、大小、非空检查）
- ✅ 实现了统一的文件命名策略（UUID）
- ✅ 支持子目录管理（goods、avatar等）
- ✅ 添加了文件删除功能
- ✅ 提供了默认头像URL获取方法
- ✅ 完善的异常处理机制：自定义`FileUploadException`在全局异常处理器统一处理文件上传异常

## 使用

::: code-group

```java [FrontUserController.java]
@PostMapping("/upload")
public JSONResult uploadFile(@RequestParam("fileName") MultipartFile fileName) {
    try {
        String imageUrl = imageUtil.uploadImage(fileName, "goods");
        return JSONResult.success("上传成功", imageUrl);
    } catch (FileUploadException e) {
        return JSONResult.fail(StatusEnum.FAIL.getCode(), e.getMessage());
    }
}
```

:::